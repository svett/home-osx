#!/bin/bash

[ -z "$DEBUG" ] || set -x

PKG_DIR="${1:-$PWD}"
PKG_COVER_FILE="$PKG_DIR/coverage.cov"

run_tests() {
  ginkgo -r -cover -coverprofile "$PKG_COVER_FILE"
}

show_cover_profile() {
  go tool cover -html="$PKG_COVER_FILE"
}

main() {
  run_tests
  show_cover_profile
}

main
